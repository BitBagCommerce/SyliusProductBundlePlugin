<?xml version="1.0" encoding="UTF-8" ?>

<!--
  ~ This file was created by developers working at BitBag
  ~ Do you need more information about us and what we do? Visit our https://bitbag.io website!
  ~ We are hiring developers from all over the world. Join us and start your new, exciting adventure and become part of us: https://bitbag.io/career
  -->

<resources
        xmlns="https://api-platform.com/schema/metadata/resources-3.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://api-platform.com/schema/metadata/resources-3.0 https://api-platform.com/schema/metadata/resources-3.0.xsd"
>
    <resource class="%sylius.model.product.class%" shortName="Product">

        <validationContext>
            <values>
                <value name="groups">
                    <values>
                        <value>sylius</value>
                    </values>
                </value>
            </values>
        </validationContext>
        <order>
            <values>
                <value name="code">
                    <values>
                        <value>ASC</value>
                    </values>
                </value>
            </values>
        </order>

        <operations>
            <operation
                    name="shop_post"
                    class="ApiPlatform\Metadata\Post"
                    uriTemplate="/shop/orders"
                    messenger="input"
                    input="Sylius\Bundle\ApiBundle\Command\Cart\PickupCart"
            >
                <denormalizationContext>
                    <values>
                        <value name="groups">shop:order:create</value>
                    </values>
                </denormalizationContext>
                <extraProperties>
                    <values>
                        <value name="summary">Pickups a new cart. Provided locale code has to be one of available for a particular channel.</value>
                    </values>
                </extraProperties>
            </operation>

            <operation
                    name="admin_get"
                    class="ApiPlatform\Metadata\Get"
                    uriTemplate="/admin/products"
            >
                <filters>
                    <filter>sylius.api.product_name_filter</filter>
                    <filter>sylius.api.product_order_filter</filter>
                    <filter>sylius.api.product_taxon_code_filter</filter>
                    <filter>sylius.api.translation_order_name_and_locale_filter</filter>
                </filters>
                <normalizationContext>
                    <values>
                        <value name="groups">admin:product:read</value>
                    </values>
                </normalizationContext>
            </operation>

            <operation
                    name="shop_get"
                    class="ApiPlatform\Metadata\Get"
                    uriTemplate="/shop/products"
            >
                <filters>
                    <filter>sylius.api.product_name_filter</filter>
                    <filter>sylius.api.product_order_filter</filter>
                    <filter>sylius.api.product_taxon_code_filter</filter>
                    <filter>sylius.api.translation_order_name_and_locale_filter</filter>
                    <filter>sylius.api.product_taxon_filter</filter>
                </filters>
                <normalizationContext>
                    <values>
                        <value name="groups">shop:product:read</value>
                    </values>
                </normalizationContext>
            </operation>

            <operation
                    name="admin_post"
                    class="ApiPlatform\Metadata\Post"
                    uriTemplate="/admin/products"
            >
                <denormalizationContext>
                    <values>
                        <value name="groups">admin:product:create</value>
                    </values>
                </denormalizationContext>
            </operation>
        </operations>

        <operations>
            <operation
                    name="admin_get"
                    class="ApiPlatform\Metadata\Get"
                    uriTemplate="/admin/products/{code}"
            >
                <extraProperties>
                    <values>
                        <value name="summary">Use code to retrieve a product resource.</value>
                    </values>
                </extraProperties>
                <normalizationContext>
                    <values>
                        <value name="groups">admin:product:read</value>
                    </values>
                </normalizationContext>
            </operation>

            <operation
                    name="shop_get"
                    class="ApiPlatform\Metadata\Get"
                    uriTemplate="/shop/products/{code}"
            >
                <extraProperties>
                    <values>
                        <value name="summary">Use code to retrieve a product resource.</value>
                    </values>
                </extraProperties>
                <normalizationContext>
                    <values>
                        <value name="groups">shop:product:read</value>
                    </values>
                </normalizationContext>
            </operation>

            <operation
                    name="admin_put"
                    class="ApiPlatform\Metadata\Put"
                    uriTemplate="/admin/products/{code}"
            >
                <denormalizationContext>
                    <values>
                        <value name="groups">admin:product:update</value>
                    </values>
                </denormalizationContext>
            </operation>

            <operation
                    name="admin_delete"
                    class="ApiPlatform\Metadata\Delete"
                    uriTemplate="/admin/products/{code}"
            />
        </operations>

        <operations>
            <operation
                    name="product_bundle_get_subresource"
                    class="ApiPlatform\Metadata\Get"
                    uriTemplate="/shop/products/{code}/bundle"
            />
        </operations>

<!--        <property name="id" identifier="false" writable="false" />-->
<!--        <property name="code" identifier="true" required="true" />-->
<!--        <property name="createdAt" writable="false" />-->
<!--        <property name="updatedAt" writable="false" />-->
<!--        <property name="translations" readable="true" writable="true">-->
<!--            <attribute name="openapi_context">-->
<!--                <attribute name="type">object</attribute>-->
<!--                <attribute name="example">-->
<!--                    <attribute name="en_US">-->
<!--                        <attribute name="name">string</attribute>-->
<!--                        <attribute name="slug">string</attribute>-->
<!--                        <attribute name="locale">string</attribute>-->
<!--                    </attribute>-->
<!--                </attribute>-->
<!--            </attribute>-->
<!--        </property>-->
<!--        <property name="productTaxons" readable="true" writable="true" />-->
<!--        <property name="reviews" required="false" />-->
<!--        <property name="options" required="false" />-->
<!--        <property name="channels" required="false" />-->
<!--        <property name="images" required="false" />-->
<!--        <property name="mainTaxon" required="false" />-->
<!--        <property name="variants" readable="true"/>-->
<!--        <property name="averageRating" readable="true" />-->
<!--        <property name="productBundle" writable="false">-->
<!--            <subresource resourceClass="%bitbag_sylius_product_bundle.model.product_bundle.class%" collection="false" />-->
<!--        </property>-->
<!--        <property name="bundle" writable="false" />-->
    </resource>
</resources>
